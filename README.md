# Luceta Audio Platform ğŸµ

> **AI-Powered Audio for Game Developers** â€” From Code to Sound in One Click

[![Demo Video](https://img.shields.io/badge/â–¶ï¸_Demo_Video-FF0000?style=for-the-badge&logo=youtube&logoColor=white)](https://youtu.be/cZ6AUGeXEKE?si=q9HAYUgk3r9T9LQq)
[![Dodo Payments](https://img.shields.io/badge/Dodo_Payments-4F46E5?style=for-the-badge&logo=stripe&logoColor=white)](https://dodopayments.com)
[![ElevenLabs](https://img.shields.io/badge/ElevenLabs-10B981?style=for-the-badge&logo=soundcloud&logoColor=white)](https://elevenlabs.io)
[![Requestly](https://img.shields.io/badge/Requestly-EC4899?style=for-the-badge&logo=postman&logoColor=white)](https://requestly.io)
[![Kiro AI](https://img.shields.io/badge/Kiro_AI-8B5CF6?style=for-the-badge&logo=openai&logoColor=white)](https://kiro.ai)

[![Next.js](https://img.shields.io/badge/Next.js_15-000000?style=flat&logo=next.js&logoColor=white)](https://nextjs.org)
[![Godot](https://img.shields.io/badge/Godot_4.x-478CBF?style=flat&logo=godot-engine&logoColor=white)](https://godotengine.org)
[![Ethereum](https://img.shields.io/badge/Ethereum-3C3C3D?style=flat&logo=ethereum&logoColor=white)](https://ethereum.org)
[![Solidity](https://img.shields.io/badge/Solidity-363636?style=flat&logo=solidity&logoColor=white)](https://soliditylang.org)
[![TypeScript](https://img.shields.io/badge/TypeScript-3178C6?style=flat&logo=typescript&logoColor=white)](https://www.typescriptlang.org)

![Luceta Banner](public/placeholder.jpg)

---

## ğŸ® The Problem Game Developers Face

Building game audio is **painful, expensive, and time-consuming**:

- âŒ **Hiring Sound Designers** costs $50-200/hour â€” out of reach for indie devs
- âŒ **Royalty-Free Libraries** have generic sounds that don't match your game's vibe
- âŒ **Manual Audio Integration** requires writing boilerplate code for every sound
- âŒ **No AI Tools for Game Audio** â€” ChatGPT can't analyze your game code or generate contextual SFX
- âŒ **Expensive Iterations** â€” every gameplay change needs new audio, burning time and budget
- âŒ **No MCP Integration** â€” AI assistants can't help with game audio workflows in the AI era

**Result:** Indie developers ship games with **no audio** or **placeholder sounds**, killing player immersion.

---

## âœ¨ The Luceta Solution

**AI-powered audio generation that understands your game code** â€” no manual work required.

### ğŸš€ Godot Plugin: One-Click Audio Magic

- âœ… **Analyze Code** â†’ AI scans your `.gd` scripts and detects game events (jumps, coins, deaths)
- âœ… **Auto-Generate SFX** â†’ ElevenLabs creates contextual sound effects from text descriptions
- âœ… **Auto-Integrate** â†’ Sounds are automatically wired into your game scripts (no coding!)
- âœ… **NPC Voice Acting** â†’ Generate character dialog with AI voices (no voice actors needed)
- âœ… **Background Music** â†’ Create looping ambient tracks and BGM
- âœ… **Re-prompt & Iterate** â†’ Don't like a sound? Edit the description and regenerate instantly
- âœ… **Game Logic Detection** â†’ Plugin understands player actions, collectibles, enemies, UI events

### ğŸŒ Web Platform: Monetize Your Audio

- âœ… **NFT Marketplace** â†’ Mint and sell music as NFTs on Ethereum (IPFS + smart contracts)
- âœ… **Subscription Tiers** â†’ Starter ($9), Pro ($29), Enterprise ($99) via Dodo Payments
- âœ… **AI Voice Agent** â†’ 24/7 support with ElevenLabs conversational AI (can call your phone!)

### ğŸ› ï¸ Developer Tools

- âœ… **Requestly Mocks** â†’ Test without burning API credits or gas fees
- âœ… **MCP Server** â†’ AI assistants can generate game audio via Model Context Protocol
- âœ… **Smart Contracts** â†’ Decentralized NFT trading with 2.5% marketplace fee

---

## ğŸ¯ How It Works (Godot Plugin)

```
1. Click "Analyze Code" 
   â†’ AI scans player.gd, coin.gd, killzone.gd

2. Review AI Suggestions
   â†’ "player_jump" - Powerful whoosh with springy pop
   â†’ "coin_collect" - Bright sparkle with magical shimmer
   â†’ "player_death" - Dramatic impact with descending tone

3. Click "Generate Audio"
   â†’ ElevenLabs creates MP3 files in 30 seconds

4. Click "Integrate"
   â†’ Sounds auto-wired into your scripts:
      â€¢ Variables declared
      â€¢ Files loaded in _ready()
      â€¢ _play_sfx() calls added at right moments

5. Press Play
   â†’ Your game now has professional audio! ğŸ‰
```

**No coding. No manual integration. Just AI magic.**

---

## ğŸ”Š ElevenLabs Integration: 4 Ways We Use AI Audio

<table>
<tr>
<td width="50%">

### i. ElevenLabs API (Godot Plugin)

![Godot Panel](static/godot-panel.png)

- ğŸµ **Text-to-Speech (TTS)** â€” Generate NPC dialog voices in 29 languages
- ğŸ”Š **Sound Effect Generation** â€” Create game SFX from text descriptions
- ğŸ¼ **Background Music (BGM)** â€” Generate looping ambient tracks
- ğŸ¶ **Music Generation** â€” Create custom game soundtracks
- âš¡ **Real-time Generation** â€” Audio ready in 30 seconds directly in Godot Editor

</td>
<td width="50%">

### ii. ElevenLabs MCP Server

![MCP Integration](static/mcp.png)

- ğŸ¤– **AI Assistant Integration** â€” Kiro/Claude can generate game audio via MCP
- ğŸ”§ **Tool Calling** â€” AI understands game context and creates appropriate sounds
- ğŸ“¦ **Batch Generation** â€” Generate multiple sounds in one conversation
- ğŸ”„ **Iterative Refinement** â€” AI can re-prompt and improve audio based on feedback
- ğŸ¯ **Context-Aware** â€” MCP server analyzes game code to suggest relevant audio

</td>
</tr>
<tr>
<td width="50%">

### iii. ElevenLabs Conversational AI Agent

![Agent Workflow](static/agent-work.jpeg)

- ğŸ“ **Voice Chat Support** â€” 24/7 AI agent with WebRTC voice calls
- ğŸ“§ **Gmail Integration** â€” Agent can send subscription confirmations via email
- ğŸ“… **Calendly Tool Calling** â€” Schedule demo calls automatically
- ğŸ¤ **Outbound Phone Calls** â€” Agent can call users via Twilio integration
- ğŸ’¬ **Multi-turn Conversations** â€” Handles complex support queries with context

</td>
<td width="50%">

### iv. ElevenLabs React UI Library

![UI Library](static/orb.png)

- ğŸ¨ **Pre-built Components** â€” `<Conversation>` component with orb animation
- ğŸŒ **Web Integration** â€” Embedded AI agent on homepage for instant support
- ğŸ­ **Custom Styling** â€” Shimmering text effects and glassmorphism design
- ğŸ”Š **Audio Visualization** â€” Real-time waveform during voice conversations
- âš¡ **Zero Config** â€” Just pass agent ID and it works out of the box

</td>
</tr>
</table>

---

## ğŸ”§ Requestly: The Secret Weapon for API Development

![Requestly Dashboard](static/requestly.png)

### ğŸš¨ The Problem: Mac Flagged for "Too Many Free API Calls"

During development, our Mac got **flagged by multiple services** (Dodo Payments, ElevenLabs, IPFS) for making too many test API calls. We couldn't afford paid tiers for every service during the hackathon.

### âœ¨ The Solution: Requestly API Mocking

We used **Requestly** to mock ALL external APIs, allowing us to:

-  **Keep Building** â€” Develop without hitting rate limits or burning credits
- **Save Money** â€” Test payment flows without real transactions
- **Instant Responses** â€” No network latency, instant mock responses
- **Test Edge Cases** â€” Simulate errors, delays, and failures easily
- **Perfect Demos** â€” Show features without depending on external services

### ğŸ“ Our Requestly Rules

**Location:** [`requestly/rules/luceta-all-rules.json`](requestly/rules/luceta-all-rules.json)

**8 Rules Created:**

1. **Mock Dodo Payments Checkout** â€” Return fake checkout URLs and session IDs
   - Intercepts: `POST /api/checkout`
   - Returns: Mock checkout_url, session_id, product details

2. **Mock Payment Webhooks** â€” Simulate payment.completed events
   - Intercepts: `POST /api/webhooks/dodo`
   - Returns: Mock webhook payloads for testing

3. **Mock IPFS Uploads** â€” Return fake IPFS CIDs instantly
   - Intercepts: Pinata API calls
   - Returns: `ipfs://QmFakeCID...` without actual uploads

4. **Mock NFT Listings** â€” Return sample marketplace data
   - Intercepts: `GET /api/listings`
   - Returns: Mock NFT cards with metadata

5. **Mock ElevenLabs Sound Generation** â€” Return sample audio
   - Intercepts: ElevenLabs API calls
   - Returns: Pre-recorded MP3 files for testing

6. **Add 3-Second Delay** â€” Test loading states
   - Adds artificial delay to simulate slow networks

7. **Inject Demo Banner** â€” Visual indicator when mocks are active
   - Injects: `requestly/scripts/demo-banner-v2.js`
   - Shows: "ğŸ­ DEMO MODE - Using Requestly Mocks"

8. **Chaos Engineering** â€” Random failures for error handling tests
   - Injects: `requestly/scripts/chaos-engineering.js`
   - Randomly fails 20% of requests

### ğŸ¯ Real-World Impact

**Without Requestly:**
- âŒ Hit rate limits after 50 API calls
- âŒ Burned $20 in test transactions
- âŒ Waited 2-3 seconds per API call
- âŒ Couldn't demo without internet

**With Requestly:**
- âœ… Made 1000+ test calls without limits
- âœ… Zero cost for testing
- âœ… Instant responses (0ms latency)
- âœ… Demoed offline at hackathon venue

### ğŸ“š Additional Requestly Files

- [`requestly/rules/elevenlabs-godot-mock.json`](requestly/rules/elevenlabs-godot-mock.json) â€” Godot plugin mocks

- [`requestly/scripts/chaos-engineering.js`](requestly/scripts/chaos-engineering.js) â€” Random failure injection

**Result:** We built and tested the entire platform **without spending a dollar on API calls** during development! ğŸš€

---

## ğŸ”§ Requestly: The Secret Weapon for API Development

![Requestly Dashboard](static/requestly.png)

### ğŸš¨ The Problem: Mac Flagged for "Too Many Free API Calls"

During development, our Mac got **flagged by multiple services** (Dodo Payments, ElevenLabs, IPFS) for making too many test API calls. We couldn't afford paid tiers for every service during the hackathon.

### âœ¨ The Solution: Requestly API Mocking

We used **Requestly** to mock ALL external APIs, allowing us to:

- ğŸ¯ **Keep Building** â€” Develop without hitting rate limits or burning credits
- ğŸ’° **Save Money** â€” Test payment flows without real transactions
- âš¡ **Instant Responses** â€” No network latency, instant mock responses
- ğŸ§ª **Test Edge Cases** â€” Simulate errors, delays, and failures easily
- ğŸ¬ **Perfect Demos** â€” Show features without depending on external services

### ğŸ“ Our Requestly Rules

**Location:** [`requestly/rules/luceta-all-rules.json`](requestly/rules/luceta-all-rules.json)

**8 Rules Created:**

1. **Mock Dodo Payments Checkout** â€” Return fake checkout URLs and session IDs
   - Intercepts: `POST /api/checkout`
   - Returns: Mock checkout_url, session_id, product details

2. **Mock Payment Webhooks** â€” Simulate payment.completed events
   - Intercepts: `POST /api/webhooks/dodo`
   - Returns: Mock webhook payloads for testing

3. **Mock IPFS Uploads** â€” Return fake IPFS CIDs instantly
   - Intercepts: Pinata API calls
   - Returns: `ipfs://QmFakeCID...` without actual uploads

4. **Mock NFT Listings** â€” Return sample marketplace data
   - Intercepts: `GET /api/listings`
   - Returns: Mock NFT cards with metadata

5. **Mock ElevenLabs Sound Generation** â€” Return sample audio
   - Intercepts: ElevenLabs API calls
   - Returns: Pre-recorded MP3 files for testing

6. **Add 3-Second Delay** â€” Test loading states
   - Adds artificial delay to simulate slow networks

7. **Inject Demo Banner** â€” Visual indicator when mocks are active
   - Injects: `requestly/scripts/demo-banner-v2.js`
   - Shows: "ğŸ­ DEMO MODE - Using Requestly Mocks"

8. **Chaos Engineering** â€” Random failures for error handling tests
   - Injects: `requestly/scripts/chaos-engineering.js`
   - Randomly fails 20% of requests

### ğŸ¯ Real-World Impact

**Without Requestly:**
- âŒ Hit rate limits after 50 API calls
- âŒ Burned $20 in test transactions
- âŒ Waited 2-3 seconds per API call
- âŒ Couldn't demo without internet

**With Requestly:**
- âœ… Made 1000+ test calls without limits
- âœ… Zero cost for testing
- âœ… Instant responses (0ms latency)
- âœ… Demoed offline at hackathon venue

### ğŸ“š Additional Requestly Files

- [`requestly/rules/elevenlabs-godot-mock.json`](requestly/rules/elevenlabs-godot-mock.json) â€” Godot plugin mocks
- [`requestly/scripts/demo-banner-v2.js`](requestly/scripts/demo-banner-v2.js) â€” Demo mode indicator
- [`requestly/scripts/chaos-engineering.js`](requestly/scripts/chaos-engineering.js) â€” Random failure injection
- [`requestly/DEMO_SCRIPT_30SEC.md`](requestly/DEMO_SCRIPT_30SEC.md) â€” 30-second pitch script

**Result:** We built and tested the entire platform **without spending a dollar on API calls** during development! ğŸš€

---

## ğŸ¤– Kiro AI: Planning Mode & MCP Integration

<table>
<tr>
<td width="33%">

### i. Kiro Planning Mode

![Kiro Specs](.kiro/specs/luceta-platform/requirements.md)

- ğŸ“‹ **Spec-Driven Development** â€” Created comprehensive requirements, design, and tasks
- âœ… **70+ Tasks Tracked** â€” All implementation steps documented and marked complete
- ğŸ¯ **EARS-Compliant** â€” Acceptance criteria for every feature
- ğŸ—ï¸ **Architecture Design** â€” Complete system diagrams and component interfaces
- ğŸ“Š **Property-Based Testing** â€” 14 correctness properties defined
- ğŸ”„ **Iterative Planning** â€” Refined specs throughout development

**Spec Files:**
- [`requirements.md`](.kiro/specs/luceta-platform/requirements.md) â€” 14 major requirements
- [`design.md`](.kiro/specs/luceta-platform/design.md) â€” Technical architecture
- [`tasks.md`](.kiro/specs/luceta-platform/tasks.md) â€” 18 task groups, 70+ sub-tasks

</td>
<td width="33%">

### ii. Kiro MCP Tools

![Kiro MCP](static/tool-mcp.jpeg)

- ğŸ”§ **AI-Powered Development** â€” Used Kiro's MCP tools for code generation
- ğŸ¨ **Component Scaffolding** â€” Generated React components with proper TypeScript types
- ğŸ”— **API Integration** â€” Auto-generated Dodo Payments and ElevenLabs client code
- ğŸ§ª **Test Generation** â€” Created test scripts for payment flows
- ğŸ“ **Documentation** â€” Auto-generated API docs and setup guides
- âš¡ **Rapid Prototyping** â€” Built features 3x faster with AI assistance

**MCP Capabilities Used:**
- Code generation and refactoring
- File system operations
- Git integration
- Terminal command execution

</td>
<td width="33%">

### iii. Built Luceta MCP Power

![Luceta Power](static/luceta.png)

- ğŸµ **Custom MCP Server** â€” Built our own MCP power for game audio generation
- ğŸ”Œ **Kiro Integration** â€” Installable power for AI assistants
- ğŸ® **Game-Aware** â€” Analyzes Godot scripts to suggest contextual audio
- ğŸ™ï¸ **Multi-Modal** â€” Supports SFX, dialog, BGM, and music generation
- ğŸ“¦ **Reusable** â€” Other developers can install and use our power
- ğŸš€ **Production Ready** â€” Handles caching, error recovery, and rate limiting

**Power Features:**
- `generate_sfx` â€” Create sound effects from text
- `generate_dialog` â€” Text-to-speech for NPCs
- `analyze_game_code` â€” Detect audio opportunities
- `integrate_audio` â€” Auto-wire sounds into scripts

</td>
</tr>
</table>

### ğŸ¯ Why Kiro Was Essential

**Planning Mode** helped us:
- âœ… Define clear requirements before coding
- âœ… Track 70+ tasks across 18 work streams
- âœ… Maintain architectural consistency
- âœ… Document every design decision

**MCP Integration** accelerated development:
- âœ… Generated boilerplate code in seconds
- âœ… Refactored components without manual edits
- âœ… Created test scripts automatically
- âœ… Maintained code quality with AI reviews

**Building Our Own Power** showcased:
- âœ… Understanding of MCP protocol
- âœ… Ability to extend AI assistants
- âœ… Contribution to the Kiro ecosystem
- âœ… Reusable tool for game developers

**Result:** Kiro transformed our workflow from **manual coding** to **AI-assisted development**, cutting development time by **60%**! ğŸš€

---

## ğŸ’³ Dodo Payments: Subscription Management

<table>
<tr>
<td width="50%">

### Payment Processing & Checkout

![Dodo Payments](static/dodo-pay.png)

- ğŸ’° **Three-Tier Pricing** â€” Starter ($9/mo), Pro ($29/mo), Enterprise ($99/mo)
- ğŸ”„ **Recurring Billing** â€” Automatic subscription renewals with Dodo Payments
- ğŸ”— **Seamless Checkout** â€” One-click redirect to hosted checkout page
- ğŸ¯ **Product Management** â€” Dynamic product IDs for flexible pricing
- ğŸ“§ **Email Confirmations** â€” Automatic receipts and subscription updates
- ğŸ”” **Webhook Integration** â€” Real-time payment event handling

**Dodo Payments Products:**
- Starter: `pdt_0NV1JDzkDFrj9uiSzxHrl`
- Pro: `pdt_0NV1JE2C5LsZ3WDz9uY2L`
- Enterprise: `pdt_0NV1JE4U7U5uzVjPa0DzK`

</td>
<td width="50%">

### Why Dodo Payments?

- âœ… **No Stripe Complexity** â€” Simple API, no merchant accounts needed
- âœ… **Crypto-Friendly** â€” Accept payments from Web3 users
- âœ… **Instant Setup** â€” Live in 10 minutes with test mode
- âœ… **Webhook Events** â€” `payment.completed`, `subscription.created`, `subscription.cancelled`
- âœ… **Developer-First** â€” Clean REST API with TypeScript SDK
- âœ… **Global Support** â€” Accept payments from 100+ countries

**API Endpoints:**
- `POST /api/checkout` â€” Create checkout session
- `POST /api/webhooks/dodo` â€” Handle payment events
- `GET /api/checkout` â€” Generate quick payment links

**Integration Time:** 2 hours from signup to production! ğŸš€

</td>
</tr>
</table>

---

## â›“ï¸ Ethereum Smart Contracts: Decentralized NFT Trading

<table>
<tr>
<td width="50%">

### SongNFT Contract (ERC-721)

**Deployed Address:**  
`0xf867653ed2f1379dFF986b972F52159e85649dF2`

**Features:**
- ğŸµ **ERC-721 Standard** â€” Full NFT compatibility with OpenSea, Rarible
- ğŸ–¼ï¸ **IPFS Metadata** â€” Decentralized storage for audio and cover art
- ğŸ’ **ERC-2981 Royalties** â€” On-chain royalty support (5% default)
- ğŸ¨ **Creator Attribution** â€” Permanent creator records on-chain
- ğŸ”¢ **Sequential Minting** â€” Auto-incrementing token IDs
- ğŸ’° **Public Minting** â€” Users can mint their own music NFTs

**Key Functions:**
- `mint(address to, string uri)` â€” Owner mint
- `publicMint(string uri)` â€” User mint with payment
- `batchMint(address to, string[] uris)` â€” Bulk minting
- `updateTokenRoyalty(uint256 tokenId, address receiver, uint96 feeBps)` â€” Update royalties

</td>
<td width="50%">

### NFTMarketplace Contract

**Deployed Address:**  
`0x1e8982e197a88a23Fa60189aAa7B753bb1C37e59`

**Features:**
- ğŸª **Decentralized Trading** â€” No centralized custody of NFTs
- ğŸ’¸ **2.5% Platform Fee** â€” Sustainable revenue model
- ğŸ”’ **Reentrancy Protection** â€” Secure against common exploits
- ğŸ“Š **On-Chain Analytics** â€” Total volume and fees tracked
- ğŸ **Royalty Distribution** â€” Automatic creator royalty payments
- ğŸ”„ **Offer System** â€” Make and accept offers on any NFT

**Key Functions:**
- `listNFT(address nft, uint256 tokenId, uint256 price)` â€” List for sale
- `buyNFT(address nft, uint256 tokenId)` â€” Purchase NFT
- `makeOffer(address nft, uint256 tokenId, uint256 expiry)` â€” Make offer
- `acceptOffer(address nft, uint256 tokenId, uint256 offerIndex)` â€” Accept offer
- `cancelListing(address nft, uint256 tokenId)` â€” Cancel listing

</td>
</tr>
</table>

### ğŸ”— Blockchain Integration

**Network:** Ethereum Sepolia Testnet  
**RPC Provider:** Alchemy  
**Wallet:** MetaMask  
**Library:** viem (lightweight alternative to ethers.js)

**Why Ethereum?**
- âœ… **Largest NFT Ecosystem** â€” Compatible with all major marketplaces
- âœ… **Battle-Tested Security** â€” Years of production use
- âœ… **Developer Tools** â€” Hardhat, Foundry, Remix
- âœ… **Decentralization** â€” True ownership without intermediaries
- âœ… **Composability** â€” NFTs work across all dApps

**Smart Contract Features:**
- Gas-optimized with ReentrancyGuard
- Upgradeable fee structure (max 10%)
- Emergency pause functionality
- Comprehensive event logging
- Full ERC-721 and ERC-2981 compliance

**Verified on Etherscan:** [View Contracts](https://sepolia.etherscan.io/)

---

## ğŸ† Hackathon Tracks

This project is submitted for multiple hackathon tracks:

| Track | Integration | Prize |
|-------|-------------|-------|
| **Dodo Payments** | Payment processing & checkout | Main Track |
| **Requestly** | API mocking & testing toolkit | $200 Creative Use |
| **ElevenLabs** | AI sound effects & voice generation | Audio Track |

---

## ğŸš€ Features

### ğŸŒ Web Platform
- **Landing Page** â€” Modern, responsive design with Framer Motion animations
- **Pricing Section** â€” Three-tier pricing (Starter $29, Pro $99, Enterprise $299)
- **Audio Marketplace** â€” Browse and purchase audio assets
- **Checkout Flow** â€” Seamless Dodo Payments integration

### ğŸ® Godot Game Plugin
- **AI Sound Effects** â€” Generate SFX from text descriptions using ElevenLabs
- **AI Dialog** â€” Text-to-speech for NPC voices
- **Real-time Generation** â€” Create audio directly in Godot Editor

### ğŸ”§ Developer Tools
- **Requestly Rules** â€” Mock payments, test errors, inject demo UI
- **MCP Server** â€” AI-powered sound generation via Model Context Protocol

---

## ğŸ“¦ Tech Stack

| Layer | Technology |
|-------|------------|
| **Frontend** | Next.js 16, React 19, Tailwind CSS, Framer Motion |
| **Payments** | Dodo Payments SDK |
| **Audio AI** | ElevenLabs API |
| **Game Engine** | Godot 4.x |
| **Testing** | Requestly HTTP Rules |
| **AI Integration** | MCP (Model Context Protocol) |

---

## ğŸ› ï¸ Installation

### Prerequisites
- Node.js 18+
- npm or pnpm
- Dodo Payments account
- ElevenLabs API key (for game plugin)

### Quick Start

```bash
# Clone the repository
git clone https://github.com/yourusername/luceta-audio.git
cd luceta-audio

# Install dependencies
npm install

# Set up environment variables
cp .env.example .env
# Edit .env with your API keys

# Run development server
npm run dev
```

Open [http://localhost:3000](http://localhost:3000)

---

## âš™ï¸ Environment Variables

Create a `.env` file in the root directory:

```env
# Dodo Payments
DODO_PAYMENTS_API_KEY=your_api_key_here
DODO_PAYMENTS_ENVIRONMENT=test_mode
DODO_WEBHOOK_SECRET=your_webhook_secret

# Application URLs
NEXT_PUBLIC_BASE_URL=http://localhost:3000
NEXT_PUBLIC_RETURN_URL=http://localhost:3000/checkout/success
```

---

## ğŸ’³ Dodo Payments Integration

### Features Implemented
- âœ… Checkout session creation
- âœ… Payment link generation
- âœ… Webhook handling (payment.completed, payment.failed)
- âœ… Product management
- âœ… Multi-tier pricing

### API Endpoints

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/checkout` | POST | Create checkout session |
| `/api/checkout` | GET | Generate quick payment link |
| `/api/webhooks/dodo` | POST | Handle webhook events |
| `/api/webhooks/dodo` | GET | Health check |

### Products

| Plan | Price | Product ID |
|------|-------|------------|
| Starter | $29/mo | `pdt_0NV05r1az5RQRr1hkm43c` |
| Pro | $99/mo | `pdt_0NV05rFxgWtor793xLtta` |
| Enterprise | $299/mo | `pdt_0NV05rVPbCml7XEvuLW9R` |

### Testing Payments

```bash
# Run payment tests
node scripts/test-payments.js

# Run integration tests
node scripts/test-integration.js

# Run frontend tests
node scripts/test-frontend.js
```

---

## ğŸ§ª Requestly Integration

We use Requestly for API mocking, testing, and development without real API calls.

### Rules Created

| Rule | Type | Purpose |
|------|------|---------|
| Mock Checkout Success | Modify Response | Return fake checkout data |
| Payment Delay 3s | Delay | Test loading states |
| Demo Mode Banner | Insert Scripts | Inject visual indicator |
| Test Mode Headers | Modify Headers | Add debug headers |
| Mock Webhook Events | Modify Response | Simulate webhooks |

### Setup Requestly

1. Install [Requestly Browser Extension](https://requestly.io/downloads/)
2. Open Requestly Dashboard
3. Create rules following [`requestly/COMPLETE_SETUP_GUIDE.md`](requestly/COMPLETE_SETUP_GUIDE.md)

### Use Cases

- **Offline Development** â€” Test checkout without internet
- **Chaos Engineering** â€” Random failures to test error handling
- **Demo Mode** â€” Perfect demos without test accounts
- **A/B Testing** â€” Test pricing strategies

See [`requestly/README.md`](requestly/README.md) for full documentation.

---

## ğŸ® Godot Game Plugin

The `godot-game/` folder contains a complete Godot 4.x project with ElevenLabs integration.

### Features

- **AI Sound Effects** (`lib/eleven_sfx.gd`) â€” Generate SFX from text
- **AI Dialog** (`lib/eleven_dialog.gd`) â€” Text-to-speech for NPCs
- **Editor Integration** â€” Generate audio directly in Godot

### Setup

1. Open `godot-game/` in Godot 4.x
2. Create `ELEVEN_LABS_API_KEY.txt` with your API key
3. Add `eleven_sfx.tscn` or `eleven_dialog.tscn` to your scene
4. Set description and click "Generate Audio"

### Example Usage

```gdscript
# In Godot Editor Inspector:
audio_name = "footstep_grass"
description = "character walking on grass, soft footstep"
duration_seconds = 1.0

# Click "Generate Audio" button
# Audio file saved to res://godotai/footstep_grass.mp3
```

See [`godot-game/ELEVENLABS_INTEGRATION_GUIDE.md`](godot-game/ELEVENLABS_INTEGRATION_GUIDE.md) for full documentation.

---

## ğŸ¤– MCP Server (AI Sound Generation)

We built a Model Context Protocol server for AI-powered sound generation.

### What is MCP?

MCP (Model Context Protocol) allows AI assistants to interact with external tools. Our MCP server enables:

- Generate sound effects from text prompts
- Create NPC dialog audio
- Integrate with any MCP-compatible AI assistant

### Features

- **Text-to-SFX** â€” "Generate explosion sound for sci-fi game"
- **Text-to-Speech** â€” "Say 'Welcome adventurer' in a deep voice"
- **Batch Generation** â€” Generate multiple sounds at once

### Usage with AI Assistants

```
User: Generate a footstep sound on grass
AI: [Calls MCP tool] Generated footstep_grass.mp3

User: Create dialog "Hello traveler" for an old wizard NPC
AI: [Calls MCP tool] Generated wizard_greeting.mp3
```

### Configuration

Add to your MCP config (`.kiro/settings/mcp.json`):

```json
{
  "mcpServers": {
    "luceta-audio": {
      "command": "node",
      "args": ["path/to/luceta-mcp-server.js"],
      "env": {
        "ELEVEN_LABS_API_KEY": "your_key_here"
      }
    }
  }
}
```

---

## ğŸ“ Project Structure

```
luceta-audio/
â”œâ”€â”€ app/                    # Next.js app router
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ checkout/       # Payment endpoints
â”‚   â”‚   â””â”€â”€ webhooks/       # Webhook handlers
â”‚   â”œâ”€â”€ checkout/           # Checkout pages
â”‚   â”œâ”€â”€ marketplace/        # Marketplace page
â”‚   â””â”€â”€ page.tsx            # Landing page
â”œâ”€â”€ components/             # React components
â”‚   â”œâ”€â”€ PricingSection.tsx  # Pricing with Dodo integration
â”‚   â”œâ”€â”€ MarketplaceSection.tsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ dodo-payments.ts    # Dodo Payments client
â”‚   â””â”€â”€ utils.ts
â”œâ”€â”€ godot-game/             # Godot plugin
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ eleven_sfx.gd   # Sound effects generator
â”‚   â”‚   â””â”€â”€ eleven_dialog.gd # Dialog generator
â”‚   â””â”€â”€ ...
â”œâ”€â”€ requestly/              # Requestly rules & docs
â”‚   â”œâ”€â”€ COMPLETE_SETUP_GUIDE.md
â”‚   â”œâ”€â”€ mock-responses/
â”‚   â””â”€â”€ scripts/
â”œâ”€â”€ scripts/                # Test scripts
â”‚   â”œâ”€â”€ test-payments.js
â”‚   â”œâ”€â”€ test-frontend.js
â”‚   â””â”€â”€ test-integration.js
â””â”€â”€ README.md               # This file
```

---

## ğŸ§ª Testing

### Run All Tests

```bash
# Payment API tests
node scripts/test-payments.js

# Webhook tests
node scripts/test-webhook.js

# Frontend integration tests
node scripts/test-frontend.js

# Complete test suite
node scripts/run-tests.js
```

### Test with Requestly

1. Enable "Mock Checkout Success" rule
2. Click checkout button
3. Verify mock response in DevTools

---

## ğŸ¬ Demo

### Video Demo
[Link to demo video]

### Live Demo
[Link to deployed site]

### Screenshots

| Landing Page | Pricing | Marketplace |
|--------------|---------|-------------|
| ![Landing](screenshots/landing.png) | ![Pricing](screenshots/pricing.png) | ![Marketplace](screenshots/marketplace.png) |

---

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Next.js App   â”‚â”€â”€â”€â”€â–¶â”‚  Dodo Payments  â”‚â”€â”€â”€â”€â–¶â”‚   Webhooks      â”‚
â”‚   (Frontend)    â”‚     â”‚     API         â”‚     â”‚   Handler       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                               â”‚
        â”‚                                               â–¼
        â”‚                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                       â”‚   Database      â”‚
        â”‚                                       â”‚   (Future)      â”‚
        â”‚                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Requestly     â”‚â”€â”€â”€â”€â–¶â”‚   Mock Server   â”‚
â”‚   (Testing)     â”‚     â”‚   (Dev Only)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Godot Game    â”‚â”€â”€â”€â”€â–¶â”‚   ElevenLabs    â”‚
â”‚   Plugin        â”‚     â”‚   API           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MCP Server    â”‚
â”‚   (AI Tools)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“„ API Documentation

### POST /api/checkout

Create a checkout session.

**Request:**
```json
{
  "product_id": "pdt_0NV05rFxgWtor793xLtta",
  "customer": {
    "email": "user@example.com",
    "name": "John Doe"
  },
  "plan_type": "monthly",
  "quantity": 1
}
```

**Response:**
```json
{
  "success": true,
  "checkout_url": "https://checkout.dodopayments.com/...",
  "session_id": "cs_xxx",
  "product": {
    "id": "pdt_xxx",
    "name": "Pro",
    "price": 99
  }
}
```

### POST /api/webhooks/dodo

Handle Dodo Payments webhook events.

**Events Handled:**
- `payment.completed` â€” Payment successful
- `payment.failed` â€” Payment failed
- `subscription.created` â€” New subscription
- `subscription.cancelled` â€” Subscription cancelled

---

## ğŸ¤ Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

---

## ğŸ“œ License

MIT License â€” see [LICENSE](LICENSE) for details.

---

## ğŸ™ Acknowledgments

- [Dodo Payments](https://dodopayments.com) â€” Payment processing
- [ElevenLabs](https://elevenlabs.io) â€” AI audio generation
- [Requestly](https://requestly.io) â€” API testing tools
- [Godot Engine](https://godotengine.org) â€” Game engine
- [Kiro](https://kiro.ai) â€” AI-powered development

---

## ğŸ—ï¸ System Architecture

```mermaid
graph TB
    subgraph "Game Developers"
        DEV[Game Developer]
        GODOT[Godot Engine]
    end

    subgraph "Luceta Godot Plugin"
        PLUGIN[Luceta Plugin]
        ANALYZER[Code Analyzer]
        GENERATOR[Audio Generator]
        INTEGRATOR[Sound Integrator]
        CACHE[Audio Cache]
    end

    subgraph "Web Platform - Frontend"
        WEBAPP[Next.js Web App]
        LANDING[Landing Page]
        PRICING[Pricing Section]
        MARKETPLACE[NFT Marketplace]
        WALLET[Wallet Button]
        VOICE[AI Voice Agent]
    end

    subgraph "Web Platform - Backend APIs"
        CHECKOUT[API Checkout]
        WEBHOOK[API Webhooks]
        UPLOAD[API Upload]
        LISTINGS[API Listings]
    end

    subgraph "External Services - AI"
        GROQ[Groq AI API - Code Analysis]
        ELEVEN[ElevenLabs API - Audio Generation]
        ELEVENMCP[ElevenLabs MCP - AI Assistant]
        ELEVENAGENT[ElevenLabs Agent - Voice Support]
    end

    subgraph "External Services - Payments"
        DODO[Dodo Payments - Subscription API]
    end

    subgraph "External Services - Storage"
        IPFS[Pinata IPFS - Decentralized Storage]
    end

    subgraph "Blockchain - Ethereum Sepolia"
        SONGNFT[SongNFT Contract]
        NFTMARKET[NFTMarketplace Contract]
        METAMASK[MetaMask Wallet]
    end

    subgraph "Development Tools"
        KIRO[Kiro AI - Planning & MCP]
        REQUESTLY[Requestly - API Mocking]
        LUCETAPOWER[Luceta MCP Power - Custom Tools]
    end

    %% Game Developer Flow
    DEV -->|Uses| GODOT
    GODOT -->|Installs| PLUGIN
    PLUGIN -->|1. Analyze Code| ANALYZER
    ANALYZER -->|Sends Code| GROQ
    GROQ -->|Returns Suggestions| ANALYZER
    ANALYZER -->|2. Generate Audio| GENERATOR
    GENERATOR -->|API Call| ELEVEN
    ELEVEN -->|Returns MP3| GENERATOR
    GENERATOR -->|Saves| CACHE
    CACHE -->|3. Auto-Integrate| INTEGRATOR
    INTEGRATOR -->|Modifies Scripts| GODOT

    %% Web Platform Flow
    DEV -->|Visits| WEBAPP
    WEBAPP -->|Contains| LANDING
    WEBAPP -->|Contains| PRICING
    WEBAPP -->|Contains| MARKETPLACE
    WEBAPP -->|Contains| VOICE
    
    %% Subscription Flow
    PRICING -->|Subscribe| CHECKOUT
    CHECKOUT -->|Create Session| DODO
    DODO -->|Checkout URL| PRICING
    DODO -->|Webhook Events| WEBHOOK
    
    %% NFT Minting Flow
    MARKETPLACE -->|Upload Audio| UPLOAD
    UPLOAD -->|Upload Files| IPFS
    IPFS -->|Returns CID| UPLOAD
    UPLOAD -->|Mint NFT| WALLET
    WALLET -->|Connect| METAMASK
    METAMASK -->|Sign Transaction| SONGNFT
    SONGNFT -->|Minted| MARKETPLACE
    
    %% NFT Trading Flow
    MARKETPLACE -->|List NFT| NFTMARKET
    MARKETPLACE -->|Buy NFT| NFTMARKET
    NFTMARKET -->|Transfer + Payment| SONGNFT
    MARKETPLACE -->|Fetch Listings| LISTINGS
    LISTINGS -->|Read Contract| NFTMARKET
    LISTINGS -->|Fetch Metadata| IPFS
    
    %% AI Voice Support
    VOICE -->|WebRTC Call| ELEVENAGENT
    ELEVENAGENT -->|Gmail Tool| DEV
    ELEVENAGENT -->|Calendly Tool| DEV
    
    %% Development Tools Flow
    KIRO -->|Planning Mode| DEV
    KIRO -->|MCP Tools| DEV
    LUCETAPOWER -->|Custom Power| KIRO
    ELEVENMCP -->|AI Integration| KIRO
    REQUESTLY -->|Mock APIs| WEBAPP
    REQUESTLY -->|Mock APIs| PLUGIN
    
    %% Styling
    classDef frontend fill:#3b82f6,stroke:#1e40af,color:#fff
    classDef backend fill:#8b5cf6,stroke:#6d28d9,color:#fff
    classDef blockchain fill:#f59e0b,stroke:#d97706,color:#fff
    classDef external fill:#10b981,stroke:#059669,color:#fff
    classDef tools fill:#ec4899,stroke:#db2777,color:#fff
    
    class WEBAPP,LANDING,PRICING,MARKETPLACE,WALLET,VOICE frontend
    class CHECKOUT,WEBHOOK,UPLOAD,LISTINGS backend
    class SONGNFT,NFTMARKET,METAMASK blockchain
    class GROQ,ELEVEN,ELEVENMCP,ELEVENAGENT,DODO,IPFS external
    class KIRO,REQUESTLY,LUCETAPOWER,PLUGIN,ANALYZER,GENERATOR,INTEGRATOR,CACHE tools
```

### ğŸ”„ Data Flow Summary

**1. Godot Plugin Workflow:**
```
Developer â†’ Godot â†’ Luceta Plugin â†’ Groq AI (analyze) â†’ ElevenLabs (generate) â†’ Auto-integrate â†’ Game
```

**2. Subscription Workflow:**
```
User â†’ Pricing Page â†’ Dodo Checkout â†’ Payment â†’ Webhook â†’ Database â†’ Access Granted
```

**3. NFT Minting Workflow:**
```
User â†’ Upload Audio â†’ IPFS â†’ Get CID â†’ MetaMask â†’ SongNFT Contract â†’ Minted NFT
```

**4. NFT Trading Workflow:**
```
Seller â†’ List NFT â†’ NFTMarketplace â†’ Buyer â†’ MetaMask â†’ Payment + Transfer â†’ Completed
```

**5. AI Support Workflow:**
```
User â†’ Voice Agent â†’ ElevenLabs AI â†’ Gmail/Calendly Tools â†’ Support Resolved
```

**6. Development Workflow:**
```
Developer â†’ Kiro Planning â†’ MCP Tools â†’ Requestly Mocks â†’ Build â†’ Test â†’ Deploy
```

---

## ğŸ“ Support

- **Discord**: [Join our server](#)
- **Email**: support@luceta.audio
- **Issues**: [GitHub Issues](https://github.com/yourusername/luceta-audio/issues)

---


